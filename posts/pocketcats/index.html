<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Карманные Кошки - Дуэльная онлайн-игра | Портфолио wizoomm</title>
<meta name="keywords" content="">
<meta name="description" content="Ссылка на мой github с проектом

Браузерная онлайн-игра для двух игроков с базой данных и real-time обновлениями!
Перейти к игре



Демонстрирует пример игрового процесса - ход одного игрока
О проекте
&ldquo;Карманные Кошки&rdquo; — это многопользовательская браузерная игра, в которой два игрока соревнуются за контроль над полем 5×5. Игроки открывают тайлы, перемещают их и собирают добычу, чтобы набрать максимальное количество очков.">
<meta name="author" content="wizoomm">
<link rel="canonical" href="https://wizoomm.github.io/posts/pocketcats/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.e1f5c4cae44599655f7ff95195ff89c8cb3adbda94f2b1581a434ab2b4d4e6cf.css" integrity="sha256-4fXEyuRFmWVff/lRlf&#43;JyMs629qU8rFYGkNKsrTU5s8=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://wizoomm.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://wizoomm.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://wizoomm.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://wizoomm.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://wizoomm.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://wizoomm.github.io/posts/pocketcats/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:url" content="https://wizoomm.github.io/posts/pocketcats/">
  <meta property="og:site_name" content="Портфолио wizoomm">
  <meta property="og:title" content="Карманные Кошки - Дуэльная онлайн-игра">
  <meta property="og:description" content="Ссылка на мой github с проектом
Браузерная онлайн-игра для двух игроков с базой данных и real-time обновлениями!
Перейти к игре
Демонстрирует пример игрового процесса - ход одного игрока
О проекте “Карманные Кошки” — это многопользовательская браузерная игра, в которой два игрока соревнуются за контроль над полем 5×5. Игроки открывают тайлы, перемещают их и собирают добычу, чтобы набрать максимальное количество очков.">
  <meta property="og:locale" content="ru-ru">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2026-01-13T00:00:00+00:00">
    <meta property="article:modified_time" content="2026-01-13T00:00:00+00:00">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Карманные Кошки - Дуэльная онлайн-игра">
<meta name="twitter:description" content="Ссылка на мой github с проектом

Браузерная онлайн-игра для двух игроков с базой данных и real-time обновлениями!
Перейти к игре



Демонстрирует пример игрового процесса - ход одного игрока
О проекте
&ldquo;Карманные Кошки&rdquo; — это многопользовательская браузерная игра, в которой два игрока соревнуются за контроль над полем 5×5. Игроки открывают тайлы, перемещают их и собирают добычу, чтобы набрать максимальное количество очков.">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://wizoomm.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Карманные Кошки - Дуэльная онлайн-игра",
      "item": "https://wizoomm.github.io/posts/pocketcats/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Карманные Кошки - Дуэльная онлайн-игра",
  "name": "Карманные Кошки - Дуэльная онлайн-игра",
  "description": "Ссылка на мой github с проектом\nБраузерная онлайн-игра для двух игроков с базой данных и real-time обновлениями!\nПерейти к игре\nДемонстрирует пример игрового процесса - ход одного игрока\nО проекте \u0026ldquo;Карманные Кошки\u0026rdquo; — это многопользовательская браузерная игра, в которой два игрока соревнуются за контроль над полем 5×5. Игроки открывают тайлы, перемещают их и собирают добычу, чтобы набрать максимальное количество очков.\n",
  "keywords": [
    
  ],
  "articleBody": "Ссылка на мой github с проектом\nБраузерная онлайн-игра для двух игроков с базой данных и real-time обновлениями!\nПерейти к игре\nДемонстрирует пример игрового процесса - ход одного игрока\nО проекте “Карманные Кошки” — это многопользовательская браузерная игра, в которой два игрока соревнуются за контроль над полем 5×5. Игроки открывают тайлы, перемещают их и собирают добычу, чтобы набрать максимальное количество очков.\nИгра создана на основе реальной настольной игры “Карманные Кошки” (авторы: Александр Агилар и Ромарик Галоннье). Правила были упрощены и немного изменены для адаптации под онлайн-формат.\nОсновные возможности Регистрация и авторизация пользователей Создание и присоединение к игровым комнатам Реалтайм-обновление состояния игры Интуитивный интерфейс с визуальной обратной связью Подсчёт очков и определение победителя Технологии Frontend: HTML5, CSS3, JavaScript (Vanilla) Backend: PHP 7.4+ База данных: PostgreSQL Архитектура: RESTful API Структура проекта pocketCats/ ├── api/ # PHP API endpoints │ ├── config.php # Конфигурация БД │ ├── register.php # Регистрация │ ├── login.php # Авторизация │ ├── create_room.php # Создание комнаты │ ├── get_rooms.php # Список комнат │ ├── join_room.php # Присоединение к комнате │ ├── get_game_state.php # Состояние игры │ ├── open_tile.php # Открытие тайла │ ├── move_tile.php # Перемещение тайла │ └── ... ├── css/ │ └── style.css # Стили приложения ├── img/ # Изображения игры (тайлы, логотипы) ├── pic/ # Скриншоты и демо-видео ├── entrance.html # Страница входа ├── registration.html # Страница регистрации ├── rooms.html # Список комнат ├── game.html # Игровое поле └── rules.html # Правила игры Основные компоненты 1. Система авторизации Регистрация и вход реализованы через токен-аутентификацию:\n// api/register.php $stmt = $conn-\u003eprepare(\"SELECT register_user(:login, :password) AS token\"); $stmt-\u003eexecute([ ':login' =\u003e $login, ':password' =\u003e password_hash($password, PASSWORD_DEFAULT) ]); 2. Работа с базой данных Вся игровая логика реализована через хранимые процедуры PostgreSQL (PL/pgSQL). Это обеспечивает целостность данных и централизованную обработку правил игры на уровне БД.\nОсновные функции:\nregister_user() — регистрация пользователя и генерация токена authorize_user() — авторизация по логину и паролю create_room() — создание игровой комнаты и размещение тайлов на поле join_room() — присоединение второго игрока к комнате open_tile() — открытие тайла по координатам move_tile() — перемещение открытого тайла на допустимую позицию get_game_state_json() — получение полного состояния игры в формате JSON finish_game() — подсчёт очков и определение победителя Пример функции открытия тайла:\nCREATE OR REPLACE FUNCTION open_tile( p_token TEXT, p_game_id INT, p_x INT, p_y INT ) RETURNS JSON AS $$ DECLARE v_login TEXT; v_player_id INT; v_tile_in_game_id INT; v_type tile_type; BEGIN -- Проверка токена и получение логина SELECT ut.login INTO v_login FROM user_tokens ut WHERE ut.token = p_token; -- Проверка, что сейчас ход этого игрока -- ... логика определения текущего игрока ... -- Открытие тайла UPDATE tilesingames SET status = 'opened' WHERE gameID = p_game_id AND coordinateX = p_x AND coordinateY = p_y; -- Сохранение активного тайла для игрока INSERT INTO current_open_tiles (gameID, playerID, tileInGameID) VALUES (p_game_id, v_player_id, v_tile_in_game_id); RETURN json_build_object('status', 'success', ...); END; $$ LANGUAGE plpgsql; Пример функции перемещения тайла:\nCREATE OR REPLACE FUNCTION move_tile( p_token TEXT, p_game_id INT, p_target_x INT, p_target_y INT ) RETURNS JSON AS $$ DECLARE v_type tile_type; v_x INT; v_y INT; BEGIN -- Получение типа и координат активного тайла SELECT t.type, tig.coordinateX, tig.coordinateY INTO v_type, v_x, v_y FROM tilesingames tig JOIN tiles t ON t.tileID = tig.tileID WHERE tig.tileInGameID = v_tile_in_game_id; -- Валидация хода в зависимости от типа тайла IF v_type = 'prey' THEN -- Добыча: только соседние 8 клеток IF NOT (p_target_x BETWEEN v_x - 1 AND v_x + 1 AND p_target_y BETWEEN v_y - 1 AND v_y + 1) THEN RETURN json_build_object('status', 'error', ...); END IF; ELSIF v_type = 'cat' THEN -- Кот: на 1-2 клетки по вертикали/горизонтали IF NOT ((p_target_x = v_x AND ABS(p_target_y - v_y) IN (1,2)) OR (p_target_y = v_y AND ABS(p_target_x - v_x) IN (1,2))) THEN RETURN json_build_object('status', 'error', ...); END IF; END IF; -- Обмен местами тайлов UPDATE tilesingames SET coordinateX = v_x, coordinateY = v_y WHERE tileInGameID = v_target_tile_in_game; UPDATE tilesingames SET coordinateX = p_target_x, coordinateY = p_target_y WHERE tileInGameID = v_tile_in_game_id; RETURN json_build_object('status', 'ok', ...); END; $$ LANGUAGE plpgsql; Пример функции подсчёта очков:\nCREATE OR REPLACE FUNCTION finish_game(p_game_id INT) RETURNS VOID AS $$ DECLARE prey_rec RECORD; v_winner_clan VARCHAR(50); BEGIN -- Для каждой добычи считаем силу котов вокруг FOR prey_rec IN SELECT tig.coordinateX, tig.coordinateY, t.power FROM tilesingames tig JOIN tiles t ON t.tileID = tig.tileID WHERE tig.gameID = p_game_id AND t.type = 'prey' LOOP -- Подсчёт суммарной силы каждого клана вокруг добычи SELECT clanName INTO v_winner_clan FROM ( SELECT tc.clanName, SUM(t_cat.power) AS total_power FROM tilesingames tig_cat JOIN tiles t_cat ON t_cat.tileID = tig_cat.tileID JOIN tilesclans tc ON tc.tileID = t_cat.tileID WHERE tig_cat.gameID = p_game_id AND t_cat.type = 'cat' AND (tig_cat.coordinateX, tig_cat.coordinateY) IN ((prey_rec.coordinateX+1, prey_rec.coordinateY), (prey_rec.coordinateX-1, prey_rec.coordinateY), (prey_rec.coordinateX, prey_rec.coordinateY+1), (prey_rec.coordinateX, prey_rec.coordinateY-1)) GROUP BY tc.clanName ORDER BY total_power DESC LIMIT 1 ) winner; -- Начисление очков клану-победителю UPDATE players SET playerPoints = COALESCE(playerPoints, 0) + prey_rec.power WHERE gameID = p_game_id AND clan = v_winner_clan; END LOOP; END; $$ LANGUAGE plpgsql; PHP-скрипты вызывают эти функции через PDO:\n// api/open_tile.php $stmt = $conn-\u003eprepare('SELECT open_tile(:token, :game_id, :x, :y) AS data'); $stmt-\u003eexecute([ ':token' =\u003e $token, ':game_id' =\u003e $game_id, ':x' =\u003e $x, ':y' =\u003e $y, ]); $row = $stmt-\u003efetch(PDO::FETCH_ASSOC); echo $row['data']; // JSON-ответ от функции 3. Клиентская часть Игровое поле обновляется в реальном времени через периодические запросы:\n// game.html async function loadGameState() { const fd = new FormData(); fd.append('token', token); fd.append('game_id', gameId); const state = await callApi('get_game_state.php', fd); renderInfo(state); renderBoard(state.tiles || []); } // Автообновление каждую секунду startAutoUpdate(1000); 4. Обработка ходов Игрок открывает тайл, затем перемещает его на допустимую позицию:\n// game.html async function handleTileClick(index) { const tile = currentCells[index]; // Открытие тайла if (selectedIndex === null) { if (tile.status !== 'closed') return; const {x, y} = indexToCoords(index); await callApi('open_tile.php', {x, y}); } // Перемещение тайла else { const targetX = index % GRID_SIZE; const targetY = Math.floor(index / GRID_SIZE); await callApi('move_tile.php', {target_x: targetX, target_y: targetY}); } } 5. Визуализация игрового поля Поле рендерится динамически на основе данных с сервера:\n// game.html function renderBoard(tilesFromServer) { board.innerHTML = ''; currentCells = new Array(GRID_SIZE * GRID_SIZE).fill(null); // Заполняем закрытые клетки for (let y = 0; y \u003c GRID_SIZE; y++) { for (let x = 0; x \u003c GRID_SIZE; x++) { currentCells[coordsToIndex(x, y)] = { coordinateX: x, coordinateY: y, status: 'closed' }; } } // Накладываем открытые тайлы tilesFromServer.forEach(tile =\u003e { const x = tile.coordinateX; const y = tile.coordinateY; currentCells[coordsToIndex(x, y)] = tile; }); // Создаём кнопки для каждой клетки for (let i = 0; i \u003c GRID_SIZE * GRID_SIZE; i++) { const btn = document.createElement('button'); btn.className = 'game-tile'; const img = document.createElement('img'); img.src = getTileImage(currentCells[i]); btn.appendChild(img); btn.addEventListener('click', () =\u003e handleTileClick(i)); board.appendChild(btn); } } 6. Вычисление допустимых ходов В зависимости от типа тайла (кошка или добыча) вычисляются доступные позиции:\n// game.html function computeAvailableTargets(tile, index) { const { x, y } = indexToCoords(index); const result = []; if (tile.type === 'prey') { // Добыча может переместиться на любую соседнюю клетку for (let dx = -1; dx \u003c= 1; dx++) { for (let dy = -1; dy \u003c= 1; dy++) { if (dx === 0 \u0026\u0026 dy === 0) continue; const nx = x + dx, ny = y + dy; if (nx \u003e= 0 \u0026\u0026 nx \u003c GRID_SIZE \u0026\u0026 ny \u003e= 0 \u0026\u0026 ny \u003c GRID_SIZE) { result.push(coordsToIndex(nx, ny)); } } } } else if (tile.type === 'cat') { // Кошка может переместиться на 1-2 клетки по вертикали/горизонтали [1, 2].forEach(step =\u003e { [ {dx: step, dy: 0}, {dx: -step, dy: 0}, {dx: 0, dy: step}, {dx: 0, dy: -step} ].forEach(({dx, dy}) =\u003e { const nx = x + dx, ny = y + dy; if (nx \u003e= 0 \u0026\u0026 nx \u003c GRID_SIZE \u0026\u0026 ny \u003e= 0 \u0026\u0026 ny \u003c GRID_SIZE) { result.push(coordsToIndex(nx, ny)); } }); }); } return [...new Set(result)]; } Скриншоты Страница входа в игру\nСписок доступных игровых комнат\nИгровое поле в начале партии\nПроцесс игры с открытыми тайлами\nСтраница с правилами игры\nЭкран завершения игры с результатами\nОсобенности реализации Хранимые процедуры PostgreSQL: Вся игровая логика (валидация ходов, подсчёт очков, управление состоянием) выполняется на уровне БД через PL/pgSQL функции. Это обеспечивает целостность данных и предотвращает некорректные состояния игры. Реалтайм-обновления: Состояние игры обновляется каждую секунду через AJAX-запросы к get_game_state_json(), которая возвращает полное состояние игры в формате JSON. Токен-аутентификация: Безопасная авторизация через токены, хранящиеся в localStorage. Токены генерируются при регистрации/входе и проверяются при каждом запросе к API. Адаптивный дизайн: Интерфейс адаптируется под разные размеры экранов с использованием CSS Flexbox и Grid. Визуальная обратная связь: Подсветка доступных ходов и выбранных тайлов для улучшения пользовательского опыта. Автор: Кручинина Дарья\nПроект разработан в рамках учебного курса.\nДемо игры · Правила оригинальной игры\n",
  "wordCount" : "1396",
  "inLanguage": "en",
  "datePublished": "2026-01-13T00:00:00Z",
  "dateModified": "2026-01-13T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "wizoomm"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://wizoomm.github.io/posts/pocketcats/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Портфолио wizoomm",
    "logo": {
      "@type": "ImageObject",
      "url": "https://wizoomm.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://wizoomm.github.io/" accesskey="h" title="Портфолио wizoomm (Alt + H)">Портфолио wizoomm</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://wizoomm.github.io/" title="Главная">
                    <span>Главная</span>
                </a>
            </li>
            <li>
                <a href="https://wizoomm.github.io/about/" title="О себе">
                    <span>О себе</span>
                </a>
            </li>
            <li>
                <a href="https://wizoomm.github.io/projects/" title="Мои проекты">
                    <span>Мои проекты</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      Карманные Кошки - Дуэльная онлайн-игра
    </h1>
    <div class="post-meta"><span title='2026-01-13 00:00:00 +0000 UTC'>January 13, 2026</span>&nbsp;·&nbsp;7 min&nbsp;·&nbsp;wizoomm

</div>
  </header> 
  <div class="post-content"><p>Ссылка на мой <a href="https://github.com/wizoomm/PocketCats">github</a> с проектом</p>
<!-- raw HTML omitted -->
<p>Браузерная онлайн-игра для двух игроков с базой данных и real-time обновлениями!</p>
<p><a href="https://se.ifmo.ru/~s368382/pocketCats/entrance.html">Перейти к игре</a></p>
<!-- raw HTML omitted -->
<hr>
<p><img alt="Демо игрового процесса" loading="lazy" src="/images/gameplay-demo.gif"></p>
<p><em>Демонстрирует пример игрового процесса - ход одного игрока</em></p>
<h2 id="о-проекте">О проекте<a hidden class="anchor" aria-hidden="true" href="#о-проекте">#</a></h2>
<p>&ldquo;Карманные Кошки&rdquo; — это многопользовательская браузерная игра, в которой два игрока соревнуются за контроль над полем 5×5. Игроки открывают тайлы, перемещают их и собирают добычу, чтобы набрать максимальное количество очков.</p>
<p>Игра создана на основе реальной настольной игры <a href="https://hobbygames.ru/download/rules/karmannie-koshki-rules.pdf">&ldquo;Карманные Кошки&rdquo;</a> (авторы: Александр Агилар и Ромарик Галоннье). Правила были упрощены и немного изменены для адаптации под онлайн-формат.</p>
<h3 id="основные-возможности">Основные возможности<a hidden class="anchor" aria-hidden="true" href="#основные-возможности">#</a></h3>
<ul>
<li>Регистрация и авторизация пользователей</li>
<li>Создание и присоединение к игровым комнатам</li>
<li>Реалтайм-обновление состояния игры</li>
<li>Интуитивный интерфейс с визуальной обратной связью</li>
<li>Подсчёт очков и определение победителя</li>
</ul>
<h2 id="технологии">Технологии<a hidden class="anchor" aria-hidden="true" href="#технологии">#</a></h2>
<p><img alt="HTML5" loading="lazy" src="https://img.shields.io/badge/HTML5-E34F26?style=flat&logo=html5&logoColor=white">
<img alt="CSS3" loading="lazy" src="https://img.shields.io/badge/CSS3-1572B6?style=flat&logo=css3&logoColor=white">
<img alt="JavaScript" loading="lazy" src="https://img.shields.io/badge/JavaScript-F7DF1E?style=flat&logo=javascript&logoColor=black">
<img alt="PHP" loading="lazy" src="https://img.shields.io/badge/PHP-777BB4?style=flat&logo=php&logoColor=white">
<img alt="PostgreSQL" loading="lazy" src="https://img.shields.io/badge/PostgreSQL-316192?style=flat&logo=postgresql&logoColor=white"></p>
<ul>
<li><strong>Frontend:</strong> HTML5, CSS3, JavaScript (Vanilla)</li>
<li><strong>Backend:</strong> PHP 7.4+</li>
<li><strong>База данных:</strong> PostgreSQL</li>
<li><strong>Архитектура:</strong> RESTful API</li>
</ul>
<h2 id="структура-проекта">Структура проекта<a hidden class="anchor" aria-hidden="true" href="#структура-проекта">#</a></h2>
<pre tabindex="0"><code>pocketCats/
├── api/                    # PHP API endpoints
│   ├── config.php          # Конфигурация БД
│   ├── register.php        # Регистрация
│   ├── login.php           # Авторизация
│   ├── create_room.php     # Создание комнаты
│   ├── get_rooms.php       # Список комнат
│   ├── join_room.php       # Присоединение к комнате
│   ├── get_game_state.php  # Состояние игры
│   ├── open_tile.php       # Открытие тайла
│   ├── move_tile.php       # Перемещение тайла
│   └── ...
├── css/
│   └── style.css           # Стили приложения
├── img/                    # Изображения игры (тайлы, логотипы)
├── pic/                    # Скриншоты и демо-видео
├── entrance.html           # Страница входа
├── registration.html       # Страница регистрации
├── rooms.html              # Список комнат
├── game.html               # Игровое поле
└── rules.html              # Правила игры
</code></pre><h2 id="основные-компоненты">Основные компоненты<a hidden class="anchor" aria-hidden="true" href="#основные-компоненты">#</a></h2>
<h3 id="1-система-авторизации">1. Система авторизации<a hidden class="anchor" aria-hidden="true" href="#1-система-авторизации">#</a></h3>
<p>Регистрация и вход реализованы через токен-аутентификацию:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#75715e">// api/register.php
</span></span></span><span style="display:flex;"><span>$stmt <span style="color:#f92672">=</span> $conn<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">prepare</span>(<span style="color:#e6db74">&#34;SELECT register_user(:login, :password) AS token&#34;</span>);
</span></span><span style="display:flex;"><span>$stmt<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">execute</span>([
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;:login&#39;</span> <span style="color:#f92672">=&gt;</span> $login,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;:password&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#a6e22e">password_hash</span>($password, <span style="color:#a6e22e">PASSWORD_DEFAULT</span>)
</span></span><span style="display:flex;"><span>]);
</span></span></code></pre></div><h3 id="2-работа-с-базой-данных">2. Работа с базой данных<a hidden class="anchor" aria-hidden="true" href="#2-работа-с-базой-данных">#</a></h3>
<p>Вся игровая логика реализована через хранимые процедуры PostgreSQL (PL/pgSQL). Это обеспечивает целостность данных и централизованную обработку правил игры на уровне БД.</p>
<p><strong>Основные функции:</strong></p>
<ul>
<li><code>register_user()</code> — регистрация пользователя и генерация токена</li>
<li><code>authorize_user()</code> — авторизация по логину и паролю</li>
<li><code>create_room()</code> — создание игровой комнаты и размещение тайлов на поле</li>
<li><code>join_room()</code> — присоединение второго игрока к комнате</li>
<li><code>open_tile()</code> — открытие тайла по координатам</li>
<li><code>move_tile()</code> — перемещение открытого тайла на допустимую позицию</li>
<li><code>get_game_state_json()</code> — получение полного состояния игры в формате JSON</li>
<li><code>finish_game()</code> — подсчёт очков и определение победителя</li>
</ul>
<p><strong>Пример функции открытия тайла:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">CREATE</span> <span style="color:#66d9ef">OR</span> <span style="color:#66d9ef">REPLACE</span> <span style="color:#66d9ef">FUNCTION</span> open_tile(
</span></span><span style="display:flex;"><span>    p_token   TEXT,
</span></span><span style="display:flex;"><span>    p_game_id INT,
</span></span><span style="display:flex;"><span>    p_x       INT,
</span></span><span style="display:flex;"><span>    p_y       INT
</span></span><span style="display:flex;"><span>) <span style="color:#66d9ef">RETURNS</span> JSON <span style="color:#66d9ef">AS</span> <span style="color:#960050;background-color:#1e0010">$$</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">DECLARE</span>
</span></span><span style="display:flex;"><span>    v_login              TEXT;
</span></span><span style="display:flex;"><span>    v_player_id          INT;
</span></span><span style="display:flex;"><span>    v_tile_in_game_id    INT;
</span></span><span style="display:flex;"><span>    v_type               tile_type;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">BEGIN</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">-- Проверка токена и получение логина
</span></span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">SELECT</span> ut.login <span style="color:#66d9ef">INTO</span> v_login
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">FROM</span> user_tokens ut
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">WHERE</span> ut.token <span style="color:#f92672">=</span> p_token;
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">-- Проверка, что сейчас ход этого игрока
</span></span></span><span style="display:flex;"><span>    <span style="color:#75715e">-- ... логика определения текущего игрока ...
</span></span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">-- Открытие тайла
</span></span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">UPDATE</span> tilesingames
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">SET</span> status <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;opened&#39;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">WHERE</span> gameID <span style="color:#f92672">=</span> p_game_id
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">AND</span> coordinateX <span style="color:#f92672">=</span> p_x
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">AND</span> coordinateY <span style="color:#f92672">=</span> p_y;
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">-- Сохранение активного тайла для игрока
</span></span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">INSERT</span> <span style="color:#66d9ef">INTO</span> current_open_tiles (gameID, playerID, tileInGameID)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">VALUES</span> (p_game_id, v_player_id, v_tile_in_game_id);
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">RETURN</span> json_build_object(<span style="color:#e6db74">&#39;status&#39;</span>, <span style="color:#e6db74">&#39;success&#39;</span>, ...);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">END</span>;
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$$</span> <span style="color:#66d9ef">LANGUAGE</span> plpgsql;
</span></span></code></pre></div><p><strong>Пример функции перемещения тайла:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">CREATE</span> <span style="color:#66d9ef">OR</span> <span style="color:#66d9ef">REPLACE</span> <span style="color:#66d9ef">FUNCTION</span> move_tile(
</span></span><span style="display:flex;"><span>    p_token    TEXT,
</span></span><span style="display:flex;"><span>    p_game_id  INT,
</span></span><span style="display:flex;"><span>    p_target_x INT,
</span></span><span style="display:flex;"><span>    p_target_y INT
</span></span><span style="display:flex;"><span>) <span style="color:#66d9ef">RETURNS</span> JSON <span style="color:#66d9ef">AS</span> <span style="color:#960050;background-color:#1e0010">$$</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">DECLARE</span>
</span></span><span style="display:flex;"><span>    v_type   tile_type;
</span></span><span style="display:flex;"><span>    v_x      INT;
</span></span><span style="display:flex;"><span>    v_y      INT;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">BEGIN</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">-- Получение типа и координат активного тайла
</span></span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">SELECT</span> t.<span style="color:#66d9ef">type</span>, tig.coordinateX, tig.coordinateY
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">INTO</span> v_type, v_x, v_y
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">FROM</span> tilesingames tig
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">JOIN</span> tiles t <span style="color:#66d9ef">ON</span> t.tileID <span style="color:#f92672">=</span> tig.tileID
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">WHERE</span> tig.tileInGameID <span style="color:#f92672">=</span> v_tile_in_game_id;
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">-- Валидация хода в зависимости от типа тайла
</span></span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">IF</span> v_type <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;prey&#39;</span> <span style="color:#66d9ef">THEN</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">-- Добыча: только соседние 8 клеток
</span></span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">IF</span> <span style="color:#66d9ef">NOT</span> (p_target_x <span style="color:#66d9ef">BETWEEN</span> v_x <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span> <span style="color:#66d9ef">AND</span> v_x <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span> <span style="color:#66d9ef">AND</span>
</span></span><span style="display:flex;"><span>                p_target_y <span style="color:#66d9ef">BETWEEN</span> v_y <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span> <span style="color:#66d9ef">AND</span> v_y <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) <span style="color:#66d9ef">THEN</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">RETURN</span> json_build_object(<span style="color:#e6db74">&#39;status&#39;</span>, <span style="color:#e6db74">&#39;error&#39;</span>, ...);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">END</span> <span style="color:#66d9ef">IF</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">ELSIF</span> v_type <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;cat&#39;</span> <span style="color:#66d9ef">THEN</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">-- Кот: на 1-2 клетки по вертикали/горизонтали
</span></span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">IF</span> <span style="color:#66d9ef">NOT</span> ((p_target_x <span style="color:#f92672">=</span> v_x <span style="color:#66d9ef">AND</span> <span style="color:#66d9ef">ABS</span>(p_target_y <span style="color:#f92672">-</span> v_y) <span style="color:#66d9ef">IN</span> (<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>))
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">OR</span> (p_target_y <span style="color:#f92672">=</span> v_y <span style="color:#66d9ef">AND</span> <span style="color:#66d9ef">ABS</span>(p_target_x <span style="color:#f92672">-</span> v_x) <span style="color:#66d9ef">IN</span> (<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>))) <span style="color:#66d9ef">THEN</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">RETURN</span> json_build_object(<span style="color:#e6db74">&#39;status&#39;</span>, <span style="color:#e6db74">&#39;error&#39;</span>, ...);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">END</span> <span style="color:#66d9ef">IF</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">END</span> <span style="color:#66d9ef">IF</span>;
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">-- Обмен местами тайлов
</span></span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">UPDATE</span> tilesingames <span style="color:#66d9ef">SET</span> coordinateX <span style="color:#f92672">=</span> v_x, coordinateY <span style="color:#f92672">=</span> v_y
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">WHERE</span> tileInGameID <span style="color:#f92672">=</span> v_target_tile_in_game;
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">UPDATE</span> tilesingames <span style="color:#66d9ef">SET</span> coordinateX <span style="color:#f92672">=</span> p_target_x, coordinateY <span style="color:#f92672">=</span> p_target_y
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">WHERE</span> tileInGameID <span style="color:#f92672">=</span> v_tile_in_game_id;
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">RETURN</span> json_build_object(<span style="color:#e6db74">&#39;status&#39;</span>, <span style="color:#e6db74">&#39;ok&#39;</span>, ...);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">END</span>;
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$$</span> <span style="color:#66d9ef">LANGUAGE</span> plpgsql;
</span></span></code></pre></div><p><strong>Пример функции подсчёта очков:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">CREATE</span> <span style="color:#66d9ef">OR</span> <span style="color:#66d9ef">REPLACE</span> <span style="color:#66d9ef">FUNCTION</span> finish_game(p_game_id INT) <span style="color:#66d9ef">RETURNS</span> VOID <span style="color:#66d9ef">AS</span> <span style="color:#960050;background-color:#1e0010">$$</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">DECLARE</span>
</span></span><span style="display:flex;"><span>    prey_rec RECORD;
</span></span><span style="display:flex;"><span>    v_winner_clan VARCHAR(<span style="color:#ae81ff">50</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">BEGIN</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">-- Для каждой добычи считаем силу котов вокруг
</span></span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">FOR</span> prey_rec <span style="color:#66d9ef">IN</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">SELECT</span> tig.coordinateX, tig.coordinateY, t.power
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">FROM</span> tilesingames tig
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">JOIN</span> tiles t <span style="color:#66d9ef">ON</span> t.tileID <span style="color:#f92672">=</span> tig.tileID
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">WHERE</span> tig.gameID <span style="color:#f92672">=</span> p_game_id <span style="color:#66d9ef">AND</span> t.<span style="color:#66d9ef">type</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;prey&#39;</span>
</span></span><span style="display:flex;"><span>    LOOP
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">-- Подсчёт суммарной силы каждого клана вокруг добычи
</span></span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">SELECT</span> clanName <span style="color:#66d9ef">INTO</span> v_winner_clan
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">FROM</span> (
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">SELECT</span> tc.clanName, <span style="color:#66d9ef">SUM</span>(t_cat.power) <span style="color:#66d9ef">AS</span> total_power
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">FROM</span> tilesingames tig_cat
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">JOIN</span> tiles t_cat <span style="color:#66d9ef">ON</span> t_cat.tileID <span style="color:#f92672">=</span> tig_cat.tileID
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">JOIN</span> tilesclans tc <span style="color:#66d9ef">ON</span> tc.tileID <span style="color:#f92672">=</span> t_cat.tileID
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">WHERE</span> tig_cat.gameID <span style="color:#f92672">=</span> p_game_id
</span></span><span style="display:flex;"><span>              <span style="color:#66d9ef">AND</span> t_cat.<span style="color:#66d9ef">type</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;cat&#39;</span>
</span></span><span style="display:flex;"><span>              <span style="color:#66d9ef">AND</span> (tig_cat.coordinateX, tig_cat.coordinateY) 
</span></span><span style="display:flex;"><span>                  <span style="color:#66d9ef">IN</span> ((prey_rec.coordinateX<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>, prey_rec.coordinateY),
</span></span><span style="display:flex;"><span>                      (prey_rec.coordinateX<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, prey_rec.coordinateY),
</span></span><span style="display:flex;"><span>                      (prey_rec.coordinateX, prey_rec.coordinateY<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>),
</span></span><span style="display:flex;"><span>                      (prey_rec.coordinateX, prey_rec.coordinateY<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>))
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span> tc.clanName
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">ORDER</span> <span style="color:#66d9ef">BY</span> total_power <span style="color:#66d9ef">DESC</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">LIMIT</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        ) winner;
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">-- Начисление очков клану-победителю
</span></span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">UPDATE</span> players
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">SET</span> playerPoints <span style="color:#f92672">=</span> COALESCE(playerPoints, <span style="color:#ae81ff">0</span>) <span style="color:#f92672">+</span> prey_rec.power
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">WHERE</span> gameID <span style="color:#f92672">=</span> p_game_id <span style="color:#66d9ef">AND</span> clan <span style="color:#f92672">=</span> v_winner_clan;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">END</span> LOOP;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">END</span>;
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$$</span> <span style="color:#66d9ef">LANGUAGE</span> plpgsql;
</span></span></code></pre></div><p>PHP-скрипты вызывают эти функции через PDO:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#75715e">// api/open_tile.php
</span></span></span><span style="display:flex;"><span>$stmt <span style="color:#f92672">=</span> $conn<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">prepare</span>(<span style="color:#e6db74">&#39;SELECT open_tile(:token, :game_id, :x, :y) AS data&#39;</span>);
</span></span><span style="display:flex;"><span>$stmt<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">execute</span>([
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;:token&#39;</span>   <span style="color:#f92672">=&gt;</span> $token,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;:game_id&#39;</span> <span style="color:#f92672">=&gt;</span> $game_id,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;:x&#39;</span>       <span style="color:#f92672">=&gt;</span> $x,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;:y&#39;</span>       <span style="color:#f92672">=&gt;</span> $y,
</span></span><span style="display:flex;"><span>]);
</span></span><span style="display:flex;"><span>$row <span style="color:#f92672">=</span> $stmt<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">fetch</span>(<span style="color:#a6e22e">PDO</span><span style="color:#f92672">::</span><span style="color:#a6e22e">FETCH_ASSOC</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">echo</span> $row[<span style="color:#e6db74">&#39;data&#39;</span>]; <span style="color:#75715e">// JSON-ответ от функции
</span></span></span></code></pre></div><h3 id="3-клиентская-часть">3. Клиентская часть<a hidden class="anchor" aria-hidden="true" href="#3-клиентская-часть">#</a></h3>
<p>Игровое поле обновляется в реальном времени через периодические запросы:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#75715e">// game.html
</span></span></span><span style="display:flex;"><span><span style="color:#66d9ef">async</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">loadGameState</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">fd</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">FormData</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">fd</span>.<span style="color:#a6e22e">append</span>(<span style="color:#e6db74">&#39;token&#39;</span>, <span style="color:#a6e22e">token</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">fd</span>.<span style="color:#a6e22e">append</span>(<span style="color:#e6db74">&#39;game_id&#39;</span>, <span style="color:#a6e22e">gameId</span>);
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">state</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">callApi</span>(<span style="color:#e6db74">&#39;get_game_state.php&#39;</span>, <span style="color:#a6e22e">fd</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">renderInfo</span>(<span style="color:#a6e22e">state</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">renderBoard</span>(<span style="color:#a6e22e">state</span>.<span style="color:#a6e22e">tiles</span> <span style="color:#f92672">||</span> []);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Автообновление каждую секунду
</span></span></span><span style="display:flex;"><span><span style="color:#a6e22e">startAutoUpdate</span>(<span style="color:#ae81ff">1000</span>);
</span></span></code></pre></div><h3 id="4-обработка-ходов">4. Обработка ходов<a hidden class="anchor" aria-hidden="true" href="#4-обработка-ходов">#</a></h3>
<p>Игрок открывает тайл, затем перемещает его на допустимую позицию:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#75715e">// game.html
</span></span></span><span style="display:flex;"><span><span style="color:#66d9ef">async</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">handleTileClick</span>(<span style="color:#a6e22e">index</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">tile</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">currentCells</span>[<span style="color:#a6e22e">index</span>];
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Открытие тайла
</span></span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">selectedIndex</span> <span style="color:#f92672">===</span> <span style="color:#66d9ef">null</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">tile</span>.<span style="color:#a6e22e">status</span> <span style="color:#f92672">!==</span> <span style="color:#e6db74">&#39;closed&#39;</span>) <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">const</span> {<span style="color:#a6e22e">x</span>, <span style="color:#a6e22e">y</span>} <span style="color:#f92672">=</span> <span style="color:#a6e22e">indexToCoords</span>(<span style="color:#a6e22e">index</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">callApi</span>(<span style="color:#e6db74">&#39;open_tile.php&#39;</span>, {<span style="color:#a6e22e">x</span>, <span style="color:#a6e22e">y</span>});
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Перемещение тайла
</span></span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">targetX</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">index</span> <span style="color:#f92672">%</span> <span style="color:#a6e22e">GRID_SIZE</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">targetY</span> <span style="color:#f92672">=</span> Math.<span style="color:#a6e22e">floor</span>(<span style="color:#a6e22e">index</span> <span style="color:#f92672">/</span> <span style="color:#a6e22e">GRID_SIZE</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">callApi</span>(<span style="color:#e6db74">&#39;move_tile.php&#39;</span>, {<span style="color:#a6e22e">target_x</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">targetX</span>, <span style="color:#a6e22e">target_y</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">targetY</span>});
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="5-визуализация-игрового-поля">5. Визуализация игрового поля<a hidden class="anchor" aria-hidden="true" href="#5-визуализация-игрового-поля">#</a></h3>
<p>Поле рендерится динамически на основе данных с сервера:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#75715e">// game.html
</span></span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">renderBoard</span>(<span style="color:#a6e22e">tilesFromServer</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">board</span>.<span style="color:#a6e22e">innerHTML</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">currentCells</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Array(<span style="color:#a6e22e">GRID_SIZE</span> <span style="color:#f92672">*</span> <span style="color:#a6e22e">GRID_SIZE</span>).<span style="color:#a6e22e">fill</span>(<span style="color:#66d9ef">null</span>);
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Заполняем закрытые клетки
</span></span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">let</span> <span style="color:#a6e22e">y</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">y</span> <span style="color:#f92672">&lt;</span> <span style="color:#a6e22e">GRID_SIZE</span>; <span style="color:#a6e22e">y</span><span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">let</span> <span style="color:#a6e22e">x</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">x</span> <span style="color:#f92672">&lt;</span> <span style="color:#a6e22e">GRID_SIZE</span>; <span style="color:#a6e22e">x</span><span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">currentCells</span>[<span style="color:#a6e22e">coordsToIndex</span>(<span style="color:#a6e22e">x</span>, <span style="color:#a6e22e">y</span>)] <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">coordinateX</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">x</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">coordinateY</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">y</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">status</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;closed&#39;</span>
</span></span><span style="display:flex;"><span>            };
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Накладываем открытые тайлы
</span></span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">tilesFromServer</span>.<span style="color:#a6e22e">forEach</span>(<span style="color:#a6e22e">tile</span> =&gt; {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">x</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">tile</span>.<span style="color:#a6e22e">coordinateX</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">y</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">tile</span>.<span style="color:#a6e22e">coordinateY</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">currentCells</span>[<span style="color:#a6e22e">coordsToIndex</span>(<span style="color:#a6e22e">x</span>, <span style="color:#a6e22e">y</span>)] <span style="color:#f92672">=</span> <span style="color:#a6e22e">tile</span>;
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Создаём кнопки для каждой клетки
</span></span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">let</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">i</span> <span style="color:#f92672">&lt;</span> <span style="color:#a6e22e">GRID_SIZE</span> <span style="color:#f92672">*</span> <span style="color:#a6e22e">GRID_SIZE</span>; <span style="color:#a6e22e">i</span><span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">btn</span> <span style="color:#f92672">=</span> document.<span style="color:#a6e22e">createElement</span>(<span style="color:#e6db74">&#39;button&#39;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">btn</span>.<span style="color:#a6e22e">className</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;game-tile&#39;</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">img</span> <span style="color:#f92672">=</span> document.<span style="color:#a6e22e">createElement</span>(<span style="color:#e6db74">&#39;img&#39;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">img</span>.<span style="color:#a6e22e">src</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">getTileImage</span>(<span style="color:#a6e22e">currentCells</span>[<span style="color:#a6e22e">i</span>]);
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">btn</span>.<span style="color:#a6e22e">appendChild</span>(<span style="color:#a6e22e">img</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">btn</span>.<span style="color:#a6e22e">addEventListener</span>(<span style="color:#e6db74">&#39;click&#39;</span>, () =&gt; <span style="color:#a6e22e">handleTileClick</span>(<span style="color:#a6e22e">i</span>));
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">board</span>.<span style="color:#a6e22e">appendChild</span>(<span style="color:#a6e22e">btn</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="6-вычисление-допустимых-ходов">6. Вычисление допустимых ходов<a hidden class="anchor" aria-hidden="true" href="#6-вычисление-допустимых-ходов">#</a></h3>
<p>В зависимости от типа тайла (кошка или добыча) вычисляются доступные позиции:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#75715e">// game.html
</span></span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">computeAvailableTargets</span>(<span style="color:#a6e22e">tile</span>, <span style="color:#a6e22e">index</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">x</span>, <span style="color:#a6e22e">y</span> } <span style="color:#f92672">=</span> <span style="color:#a6e22e">indexToCoords</span>(<span style="color:#a6e22e">index</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">result</span> <span style="color:#f92672">=</span> [];
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">tile</span>.<span style="color:#a6e22e">type</span> <span style="color:#f92672">===</span> <span style="color:#e6db74">&#39;prey&#39;</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Добыча может переместиться на любую соседнюю клетку
</span></span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">let</span> <span style="color:#a6e22e">dx</span> <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>; <span style="color:#a6e22e">dx</span> <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">1</span>; <span style="color:#a6e22e">dx</span><span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">let</span> <span style="color:#a6e22e">dy</span> <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>; <span style="color:#a6e22e">dy</span> <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">1</span>; <span style="color:#a6e22e">dy</span><span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">dx</span> <span style="color:#f92672">===</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">dy</span> <span style="color:#f92672">===</span> <span style="color:#ae81ff">0</span>) <span style="color:#66d9ef">continue</span>;
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">nx</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">x</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">dx</span>, <span style="color:#a6e22e">ny</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">y</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">dy</span>;
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">nx</span> <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">nx</span> <span style="color:#f92672">&lt;</span> <span style="color:#a6e22e">GRID_SIZE</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">ny</span> <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">ny</span> <span style="color:#f92672">&lt;</span> <span style="color:#a6e22e">GRID_SIZE</span>) {
</span></span><span style="display:flex;"><span>                    <span style="color:#a6e22e">result</span>.<span style="color:#a6e22e">push</span>(<span style="color:#a6e22e">coordsToIndex</span>(<span style="color:#a6e22e">nx</span>, <span style="color:#a6e22e">ny</span>));
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">tile</span>.<span style="color:#a6e22e">type</span> <span style="color:#f92672">===</span> <span style="color:#e6db74">&#39;cat&#39;</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Кошка может переместиться на 1-2 клетки по вертикали/горизонтали
</span></span></span><span style="display:flex;"><span>        [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>].<span style="color:#a6e22e">forEach</span>(<span style="color:#a6e22e">step</span> =&gt; {
</span></span><span style="display:flex;"><span>            [
</span></span><span style="display:flex;"><span>                {<span style="color:#a6e22e">dx</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">step</span>, <span style="color:#a6e22e">dy</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">0</span>}, {<span style="color:#a6e22e">dx</span><span style="color:#f92672">:</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">step</span>, <span style="color:#a6e22e">dy</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">0</span>},
</span></span><span style="display:flex;"><span>                {<span style="color:#a6e22e">dx</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">0</span>, <span style="color:#a6e22e">dy</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">step</span>}, {<span style="color:#a6e22e">dx</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">0</span>, <span style="color:#a6e22e">dy</span><span style="color:#f92672">:</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">step</span>}
</span></span><span style="display:flex;"><span>            ].<span style="color:#a6e22e">forEach</span>(({<span style="color:#a6e22e">dx</span>, <span style="color:#a6e22e">dy</span>}) =&gt; {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">nx</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">x</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">dx</span>, <span style="color:#a6e22e">ny</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">y</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">dy</span>;
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">nx</span> <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">nx</span> <span style="color:#f92672">&lt;</span> <span style="color:#a6e22e">GRID_SIZE</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">ny</span> <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">ny</span> <span style="color:#f92672">&lt;</span> <span style="color:#a6e22e">GRID_SIZE</span>) {
</span></span><span style="display:flex;"><span>                    <span style="color:#a6e22e">result</span>.<span style="color:#a6e22e">push</span>(<span style="color:#a6e22e">coordsToIndex</span>(<span style="color:#a6e22e">nx</span>, <span style="color:#a6e22e">ny</span>));
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            });
</span></span><span style="display:flex;"><span>        });
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> [...<span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Set</span>(<span style="color:#a6e22e">result</span>)];
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="скриншоты">Скриншоты<a hidden class="anchor" aria-hidden="true" href="#скриншоты">#</a></h2>
<p><img alt="Страница входа" loading="lazy" src="/images/screenshot-entrance.png">
<em>Страница входа в игру</em></p>
<p><img alt="Список комнат" loading="lazy" src="/images/screenshot-rooms.png">
<em>Список доступных игровых комнат</em></p>
<p><img alt="Начало игры" loading="lazy" src="/images/screenshot-game-start.png">
<em>Игровое поле в начале партии</em></p>
<p><img alt="Игровой процесс" loading="lazy" src="/images/screenshot-gameplay.png">
<em>Процесс игры с открытыми тайлами</em></p>
<p><img alt="Правила игры" loading="lazy" src="/images/screenshot-rules.png">
<em>Страница с правилами игры</em></p>
<p><img alt="Конец игры" loading="lazy" src="/images/screenshot-game-end.png">
<em>Экран завершения игры с результатами</em></p>
<hr>
<h2 id="особенности-реализации">Особенности реализации<a hidden class="anchor" aria-hidden="true" href="#особенности-реализации">#</a></h2>
<ul>
<li><strong>Хранимые процедуры PostgreSQL:</strong> Вся игровая логика (валидация ходов, подсчёт очков, управление состоянием) выполняется на уровне БД через PL/pgSQL функции. Это обеспечивает целостность данных и предотвращает некорректные состояния игры.</li>
<li><strong>Реалтайм-обновления:</strong> Состояние игры обновляется каждую секунду через AJAX-запросы к <code>get_game_state_json()</code>, которая возвращает полное состояние игры в формате JSON.</li>
<li><strong>Токен-аутентификация:</strong> Безопасная авторизация через токены, хранящиеся в localStorage. Токены генерируются при регистрации/входе и проверяются при каждом запросе к API.</li>
<li><strong>Адаптивный дизайн:</strong> Интерфейс адаптируется под разные размеры экранов с использованием CSS Flexbox и Grid.</li>
<li><strong>Визуальная обратная связь:</strong> Подсветка доступных ходов и выбранных тайлов для улучшения пользовательского опыта.</li>
</ul>
<hr>
<!-- raw HTML omitted -->
<p><strong>Автор:</strong> Кручинина Дарья</p>
<p>Проект разработан в рамках учебного курса.</p>
<p><a href="https://se.ifmo.ru/~s368382/pocketCats/entrance.html">Демо игры</a> · <a href="https://hobbygames.ru/download/rules/karmannie-koshki-rules.pdf">Правила оригинальной игры</a></p>
<!-- raw HTML omitted -->


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
<nav class="paginav">
  <a class="next" href="https://wizoomm.github.io/posts/taskmanager/">
    <span class="title">Next »</span>
    <br>
    <span>Разработка SPA-приложения «Менеджер задач» на Vue 3 с сервером на Python Flask</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2026 <a href="https://wizoomm.github.io/">Портфолио wizoomm</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
